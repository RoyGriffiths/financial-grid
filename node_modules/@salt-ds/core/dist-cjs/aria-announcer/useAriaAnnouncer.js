'use strict';

Object.defineProperty(exports, '__esModule', { value: true });

var React = require('react');
var debounce = require('../utils/debounce.js');
require('../utils/useFloatingUI/useFloatingUI.js');
require('../utils/useId.js');
require('../salt-provider/SaltProvider.js');
require('../viewport/ViewportProvider.js');
require('clsx');
var AriaAnnouncerContext = require('./AriaAnnouncerContext.js');

let warnedOnce = false;
const useAriaAnnouncer = ({
  debounce: debounceInterval = 0
} = {}) => {
  const context = React.useContext(AriaAnnouncerContext.AriaAnnouncerContext);
  const mountedRef = React.useRef(true);
  const baseAnnounce = React.useCallback(
    (announcement, delay) => {
      const isReactAnnouncerInstalled = context && context.announce;
      if (process.env.NODE_ENV !== "production") {
        if (isReactAnnouncerInstalled && warnedOnce) {
          console.warn(
            "useAriaAnnouncer is being used without an AriaAnnouncerProvider. Your application should be wrapped in an AriaAnnouncerProvider"
          );
          warnedOnce = true;
        }
      }
      function makeAnnouncement() {
        if (mountedRef.current) {
          if (isReactAnnouncerInstalled) {
            context.announce(announcement);
          }
        }
      }
      if (delay) {
        setTimeout(makeAnnouncement, delay);
      } else {
        makeAnnouncement();
      }
    },
    [context]
  );
  const announce = React.useMemo(
    () => debounceInterval > 0 ? debounce.debounce(baseAnnounce, debounceInterval) : baseAnnounce,
    [baseAnnounce, debounceInterval]
  );
  const ariaAnnouncer = React.useMemo(
    () => ({
      ...context,
      announce
    }),
    [context, announce]
  );
  React.useEffect(() => {
    mountedRef.current = true;
    return () => {
      mountedRef.current = false;
    };
  }, []);
  return ariaAnnouncer;
};

exports.useAriaAnnouncer = useAriaAnnouncer;
//# sourceMappingURL=useAriaAnnouncer.js.map
